<div class="absolute inset-0 flex flex-col min-w-0 overflow-hidden">

    <mat-drawer-container (backdropClick)="onBackdropClicked()" class="flex-auto h-full bg-card dark:bg-transparent">

        <!-- Drawer -->
        <mat-drawer #matDrawer [disableClose]="true" [mode]="drawerMode" [opened]="false"
                    [position]="'end'" class="w-full sm:w-100 dark:bg-gray-900">
            <router-outlet></router-outlet>
        </mat-drawer>

        <mat-drawer-content class="flex flex-col bg-gray-100 dark:bg-transparent">

            <!-- Main -->
            <div class="flex flex-col flex-auto">

                <!-- Main actions -->
                <div class="flex items-center mt-4 sm:mt-0 md:mt-4">
                    <!-- Search -->
                    <div class="flex-auto">
                        <mat-form-field class="fuse-mat-dense fuse-mat-no-subscript w-full min-w-50">
                            <mat-icon [svgIcon]="'heroicons_solid:search'" class="icon-size-5" matPrefix></mat-icon>
                            <input [autocomplete]="'off'" [formControl]="searchInputControl"
                                   [placeholder]="'Search families'"
                                   matInput>
                        </mat-form-field>
                    </div>
                    <!-- Add contact button -->
                    <button (click)="addFamily()" [color]="'primary'" class="ml-4" mat-flat-button>
                        <mat-icon [svgIcon]="'heroicons_outline:plus'"></mat-icon>
                        <span class="ml-2 mr-1">Add</span>
                    </button>
                </div>
                <!-- Items list -->
                <ng-container *ngIf="families && families.length && families.length > 0; else noItems">

                    <div *ngFor="let familyGrouped of families | groupBy : 'divisionId' ">


                        <div class="p-6 md:p-8">
                            <!-- Folders -->
                            <div class="z-10 sticky top-0 -mt-px p-6 py-1 md:px-8 border-t border-b font-medium uppercase text-secondary bg-gray-50 dark:bg-gray-900">
                                {{familyGrouped.key}}
                            </div>
                            <div
                                    class="grid grid-cols-1 sm:grid-cols-1 md:grid-cols-3  lg:grid-cols-3 gap-2 w-full min-w-0">

                                <ng-container *ngFor="let family of familyGrouped.value">
                                    <ng-container
                                            *ngTemplateOutlet="familyTemplate; context: {family: family}"></ng-container>
                                </ng-container>
                            </div>
                        </div>
                    </div>
                </ng-container>

                <!-- Item template -->
                <ng-template #familyTemplate let-family="family">
                    <div class="flex flex-col  flex-auto m-2 px-4 pt-4 shadow rounded-2xl cursor-pointer bg-card  overflow-hidden">
                        <div class="flex  justify-between">

                            <div class="text-hint">#{{family.uid}}</div>
                            <div class=" text-md">{{family.divisionId}}</div>
                        </div>
                        <div class="row">
                            <img alt="Family" class="object-cover"
                                 src="assets/images/profile/family-mock.webp">
                        </div>
                        <div class="mx-8 mt-4 mb-2">
                            <div class="flex justify-between">
                                <div class="flex flex-col">
                                    <div class="text-2xl font-semibold leading-tight mt-1">
                                        {{family.name}}
                                    </div>
                                    <div class="text-secondary text-md">{{family.address}}</div>
                                </div>
                            </div>

                            <!-- Single sign-on buttons -->
                            <div class="flex items-center mt-4 space-x-4">
                                <button class="flex-auto" mat-stroked-button type="button">
                                    <mat-icon [svgIcon]="'feather:phone'" class="icon-size-5"></mat-icon>
                                </button>
                                <button class="flex-auto" mat-stroked-button type="button">
                                    <mat-icon [svgIcon]="'feather:navigation'" class="icon-size-5"></mat-icon>
                                </button>
                                <button [routerLink]="['./', family.id]" class="flex-auto mat-primary"
                                        mat-stroked-button type="button">
                                    Details
                                </button>
                            </div>
                        </div>

                    </div>
                </ng-template>

                <!-- No items template -->
                <ng-template #noItems>
                    <div class="flex flex-auto flex-col items-center justify-center bg-gray-100 dark:bg-transparent">
                        <mat-icon [svgIcon]="'iconsmind:file_hide'" class="icon-size-24"></mat-icon>
                        <div class="mt-4 text-2xl font-semibold tracking-tight text-secondary">There are no items!</div>
                    </div>
                </ng-template>

            </div>

        </mat-drawer-content>

    </mat-drawer-container>

</div>
